## 数据同步到外设的两种方法

数据从缓冲区同步到硬盘有两种方法。
* 通过updata定期同步；
* 因缓冲区使用达到极限，操作系统强行同步。

### 第一种方法：通过updata定期同步
shell进程在第一次执行时，启动了一个updata进程。
这个进程常驻于内存，功能就是将缓冲区中的数据同步到外设上。
该进程会调用pause（）函数，这个函数会映射到sys_pause（）函数中，使该进程被设置为可中断等待状态。
每隔一段时间，操作系统就将updata进程唤醒。
它执行后，调用sync（）函数，将缓冲区中的数据同步到外设上。
sync（）函数最终映射到sys_sync（）系统调用函数去执行。
为了保证文件内容同步的完整性，需要将文件i节点位图、文件i节点、文件数据块、数据块对应的逻辑块位图，全都同步到外设。
sys_sync（）函数先将改动过的文件i节点写入缓冲区（其余内容已经在缓冲区中了），之后，遍历整个缓冲区，
只要发现其中缓冲块内容被改动过（b_dirt被置1），就全部同步到外设上。